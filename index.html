<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atomic Habit Hero - AI Edition</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="app-layout">
        <div class="ai-panel">
            <img id="aiAvatar" src="/characters/Seraphina/default.png">
            <div id="aiName">Seraphina</div>
            <div id="aiSpeechBubble" class="speech-bubble">Initializing...</div>

            <label for="modelSelector" class="model-label">Choose AI Model:</label>
            <select id="modelSelector" class="model-selector">
              <option value="gemini-1.5-pro">Gemini 1.5 Pro</option>
              <option value="gemini-2.0-flash-lite">Gemini 2.0 Flash-Lite</option>
              <option value="gemini-2.0-flash">Gemini 2.0 Flash</option>
              <option value="gemini-2.5-flash-preview-04-17">Gemini 2.5 Flash Preview 04-17</option>
            </select>

            <button id="changeApiKeyBtn">Change API Key</button>
        </div>

        <div class="main-content">
            <div class="container">
                <h1>Atomic Habit Hero</h1>
                <div class="user-stats">
                    <p>Level: <span id="currentLevel">1</span> (<span class="level-title" id="levelTitle">Novice</span>)</p>
                    <p>XP: <span id="currentXP">0</span> / <span id="xpToNextLevel">100</span></p>
                    <div class="xp-bar-container"><div class="xp-bar" id="xpBar">0%</div></div>
                    <p style="font-size: 0.9em; margin-top: 10px;">Login Streak: <span id="loginStreak">0</span> days ðŸ”¥</p>
                </div>
                <h2>Add New Habit</h2>
                <div class="input-group">
                    <input type="text" id="newHabitInput" placeholder="e.g., Meditate for 10 minutes">
                    <button id="addHabitBtn">Add Habit</button>
                </div>
                <h2>My Habits</h2>
                <ul id="habitsList" class="habits-list"></ul>
            </div>
        </div>
    </div>

    <div id="apiKeyModal" class="modal">
        <div class="modal-content">
            <h3>Gemini API Key Required</h3>
            <p>To enable your AI companion, Seraphina, please enter your Google Gemini API Key. You can get one from <a href="https://aistudio.google.com/app/apikey" target="_blank">Google AI Studio</a>.</p>
            <p>Your key will be stored locally in your browser.</p>
            <input type="text" id="apiKeyInput" placeholder="Enter your Gemini API Key">
            <button id="saveApiKeyBtn">Save Key & Activate AI</button>
        </div>
    </div>

    <div id="toastNotification" class="toast"></div>
    <script>
        const modelSelector = document.getElementById('modelSelector');
        modelSelector.value = localStorage.getItem('selectedModel') || 'gemini-2.0-flash';
        modelSelector.addEventListener('change', () => {
            localStorage.setItem('selectedModel', modelSelector.value);
        });
    </script>
    <script type="module" src="js/main.js"></script>
</body>
</html>